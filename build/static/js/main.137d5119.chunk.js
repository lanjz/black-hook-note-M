(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(t,e,n){"use strict";e.a={recentlyArticlesKey:"recently",recentlyNoteKey:"recently"}},19:function(t,e,n){"use strict";(function(t){var a=n(38),r=n.n(a),o=n(39),c=!1;r.a.defaults.withCredentials=!c;var i=Object({NODE_ENV:"production",PUBLIC_URL:""}).MOCK;function s(t){}var u=function(e){var n={err:null,data:""};return new Promise(function(a){(function(e){var n={err:null,data:""},a=e.url;if(!a)return n.err=new Error("\u6ca1\u6709\u8bf7\u6c42\u5730\u5740"),n;if(a=i?"".concat(o.a.base.mockHost,"/mock/15").concat(a):c?"http://".concat(o.a.base.devHost).concat(a):t.client?"".concat(a):"http://127.0.0.1:3001".concat(a),e.url=a,e.method=e.method||"get",e.onUploadProgress=s,e.onDownloadProgress=s,"get"===e.method.toLowerCase()&&(e.params=e.data),"formData"===e.type){e.headers={"Content-Type":"multipart/form-data"};var u=new FormData;Object.keys(e.data).forEach(function(t){u.append(t,e.data[t])}),e.data=u}return r()(e)})(e).then(function(t){var r,o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={err:null,data:t.data};return 4===t.retCode?(e.notAlert=!0,e.err=new Error("\u672a\u767b\u5f55"),window.location.href="/login?back=1",e):(1!==t.retCode&&(e.err=new Error(t.retMsg)),e)}(t.data);if(o.err)return n.err=o.err,o.notAlert||e.notAlert||(r={title:n.err.message,showCancel:!1},alert(r.title)),void a(n);n.data=o.data,a(n)}).catch(function(t){a({err:t,data:""})})})};e.a=u}).call(this,n(43))},23:function(t,e,n){"use strict";n.r(e),n.d(e,"NOTES_GET",function(){return p}),n.d(e,"NOTE_DES_GET",function(){return f}),n.d(e,"NOTE_GET_BY_ID",function(){return m}),n.d(e,"NOTES_RECENTLY_GET",function(){return h}),n.d(e,"NOTE_CUR_UPDATE",function(){return b});var a=n(2),r=n.n(a),o=n(5),c=n(11),i=n(1),s=n(19),u=n(17),l=n(3),d={list:{},curNote:"",notesMap:{},curNoteContent:{}};function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e=Object(o.a)(r.a.mark(function e(n,a){var o,c,i,u,d,p,f,m,h,b,v,O,g,E;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.limit,c=void 0===o?0:o,i=t.start,u=void 0===i?0:i,d=t.force,p=void 0!==d&&d,f=a(),m=f.notes,h=f.books.curBook,b=f.catalogs.curCatalog,v="".concat(h,"_").concat(b),p||!m.list[v]){e.next=8;break}return e.abrupt("return",{err:null,data:{list:m.list[v]}});case 8:return e.next=10,Object(s.a)({url:"/api/notes",data:{limit:c,start:u,bookId:h,catalogId:b.indexOf("root")>-1?"root":b}});case 10:return O=e.sent,g=O.err,E=O.data,g||n({type:l.m,payload:{data:E.list,start:u,key:v}}),e.abrupt("return",O);case 14:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e=Object(o.a)(r.a.mark(function e(n,a){var o,c,i,u,d,p,f,m;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.id,c=t.force,i=void 0!==c&&c,u=a(),d=u.notes,i||!d.notesMap[o]){e.next=5;break}return e.abrupt("return",{err:null,data:d.notesMap[o]});case 5:return e.next=7,Object(s.a)({url:"/api/note/".concat(o)});case 7:return p=e.sent,f=p.err,m=p.data,f||n({type:l.n,payload:{data:m,id:o}}),e.abrupt("return",p);case 11:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,n){return new Promise(function(){var a=Object(o.a)(r.a.mark(function a(o,c){var i,u,d,p,f,m,h,b,v;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=t.id,u=t.bookId,d=t.catalogId,p="".concat(u,"_").concat(d),f=n(),m=f.notes,console.log("state",m),m.list[p]&&o({err:null,data:{list:m.list[p]}}),a.next=8,Object(s.a)({url:"/api/notes/".concat(i),data:{bookId:u,catalogId:d}});case 8:h=a.sent,b=h.err,v=h.data,b||(e({type:l.m,payload:{data:v.list,start:0,key:p}}),v.extend&&v.extend.user&&e({type:l.i,payload:v.extend.user}),v.extend&&v.extend.books&&e({type:l.b,payload:{data:v.extend.books,start:0}})),o(h);case 12:case"end":return a.stop()}},a)}));return function(t,e){return a.apply(this,arguments)}}())}}function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e=Object(o.a)(r.a.mark(function e(n,a){var o,c,i,d,p,f,m,h;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.force,c=void 0!==o&&o,i=a(),d=i.notes,p=i.books.curBook+"_"+u.a.recentlyNoteKey,c||!d.list[p]){e.next=6;break}return e.abrupt("return",{err:null,data:{list:d.list[p]}});case 6:return e.next=8,Object(s.a)({url:"/api/recently_notes",method:"get",data:{bookId:i.books.curBook}});case 8:return f=e.sent,m=f.err,h=f.data,m||n({type:l.m,payload:{data:h,key:p}}),e.abrupt("return",{err:null,data:{list:h}});case 12:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}function b(t){return function(){var e=Object(o.a)(r.a.mark(function e(n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:l.l,payload:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,e=arguments.length>1?arguments[1]:void 0,n=e.type,a=e.payload;if(n===l.m){var r=a.data,o=(a.start,a.key),s=JSON.parse(JSON.stringify(t.notesMap));return r.forEach(function(t){s[t._id]=t}),Object(i.a)({},t,{list:Object(i.a)({},t.list,Object(c.a)({},o,r)),notesMap:s})}if(n===l.l){var u=a;return Object(i.a)({},t,{curNote:u})}if(n===l.n){var p=a.data,f=a.id;return Object(i.a)({},t,{notesMap:Object(i.a)({},t.notesMap,Object(c.a)({},f,p))})}if(n===l.k){var m=a;return Object(i.a)({},t,{curNoteContent:m})}return t}},274:function(t,e,n){},276:function(t,e,n){},277:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(27),c=n.n(o),i=n(24),s=(n(65),n(20)),u=n(37),l=(n(66),n(34)),d=(navigator.platform.indexOf("Win32"),Object(s.applyMiddleware)(u.a),Object(s.createStore)(l.default,Object(s.applyMiddleware)(u.a))),p=n(54),f=n(22),m=(n(85),n(86),n(87),n(1)),h=n(2),b=n.n(h),v=n(5),O=n(11),g=n(6),E=n(7),k=n(9),y=n(8),_=n(10),j=n(31),N=n.n(j),C=n(53),T=n.n(C),w=new N.a.Renderer;N.a.setOptions({renderer:w,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(t){return T.a.highlightAuto(t).value}});var I=function(t){function e(t){return Object(g.a)(this,e),Object(k.a)(this,Object(y.a)(e).call(this,t))}return Object(_.a)(e,t),Object(E.a)(e,[{key:"render",value:function(){var t,e={__html:(t=N()(this.props.curNote.content),t.replace(/C\(N\)/g,'<span class="marked-checkBox"></span>').replace(/C\(Y\)/g,'<span class="marked-checkBox"><i class="iconfont icon-gou1"></i></span>'))};return r.a.createElement("div",null,r.a.createElement("div",{className:"markdown-title"},this.props.curNote.title),r.a.createElement("div",{className:"layout-padding"},r.a.createElement("div",{className:"markdown-style"},r.a.createElement("div",{dangerouslySetInnerHTML:e}))))}}]),e}(r.a.Component),x=(n(274),function(t){function e(t){var n;return Object(g.a)(this,e),(n=Object(k.a)(this,Object(y.a)(e).call(this,t))).openCom=function(t,e){n.props.openCom(t),e.stopPropagation()},n}return Object(_.a)(e,t),Object(E.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"header-layout  flex align-items-center layout-padding",ref:this.toggleContainer},r.a.createElement("div",{className:"icon-layout"},r.a.createElement("i",{className:"iconfont icon-shuji",onClick:this.openCom.bind(this,"openBook")})),r.a.createElement("div",{className:"icon-layout",onClick:this.openCom.bind(this,"openCatalogs")},r.a.createElement("i",{className:"iconfont icon-neirong"})),r.a.createElement("div",{className:"icon-layout",onClick:this.openCom.bind(this,"openBrief")},r.a.createElement("i",{className:"iconfont icon-shujia1"})),r.a.createElement("div",{className:"logo"},"Black Hook Note"))}}]),e}(r.a.Component)),A=n(12);Object(A.a)();function S(t,e){if(!t)return"";var n=e||"YYYY-MM-DD hh:mm:ss",a=new Date(1*t),r={"M+":a.getMonth()+1,"D+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};for(var o in/(Y+)/.test(n)&&(n=n.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+o+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?r[o]:("00"+r[o]).substr((""+r[o]).length)));return n}function B(t,e){var n=S(t,"YYYY.MM.DD");return n?n.substring(2):""}var U=function(t){function e(t){var n;return Object(g.a)(this,e),(n=Object(k.a)(this,Object(y.a)(e).call(this,t))).getBookName=function(t,e){return e[t]?e[t].name:""},n.gotoNote=function(t){n.props.gotoNote(t)},n}return Object(_.a)(e,t),Object(E.a)(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=this,e=this.props,n=e.books,a=e.catalogs,o=this.props.notes.list["".concat(n.curBook,"_").concat(a.curCatalog)],c=this.props.notes.curNote;return r.a.createElement("div",{className:"layout-padding note-brief-layout"},r.a.createElement("div",{className:"note-layout-input-box align-items-center"},r.a.createElement("input",{type:"text",className:"note-layout-input"}),r.a.createElement("i",{className:"iconfont icon-sousuo"})),r.a.createElement("div",{className:"flex-1 relative"},r.a.createElement("div",{className:"absolute-full article-item-box",id:"article-item-box"},n&&o&&o.map(function(e,a){return r.a.createElement("div",{className:e._id===c?"note-item act":"note-item",key:a,onClick:t.gotoNote.bind(t,e)},r.a.createElement("div",{className:"note-item-title"},e.title),r.a.createElement("div",{className:"note-label"},r.a.createElement("span",{className:"note-label-item"},t.getBookName(e.bookId,n.list))),r.a.createElement("div",{className:"note-item-mark"},B(e.createTime),"~",B(e.updateTime)))}))))}}]),e}(r.a.Component),L=n(17);function D(t){var e=t.actCatalog,n=t.curNode,a=t.chooseCatalog,o=t.catalogs,c=t.treeChainList,i=void 0===c?[]:c;return r.a.createElement("div",{className:"catalogs-layout"},r.a.createElement("div",{className:e===n._id?"flex align-items-center catalogs-item-layout act":"flex align-items-center catalogs-item-layout",onClick:a.bind(this,n)},n.icon?r.a.createElement("i",{className:"iconfont "+n.icon}):i&&i.indexOf(n._id)>-1?r.a.createElement("i",{className:"iconfont icon-wenjianjia"}):r.a.createElement("i",{className:"iconfont icon-wendang1"}),r.a.createElement("div",{className:"catalogs-name line-ellipsis"},n.name)),n.hasChild&&o[n._id]&&o[n._id].childNodes.length?o[n._id].childNodes.map(function(e,n){return r.a.createElement(D,Object.assign({},t,{curNode:e,key:n}))}):null)}var G=function(t){function e(t){var n;return Object(g.a)(this,e),(n=Object(k.a)(this,Object(y.a)(e).call(this,t))).chooseCatalog=function(t){n.props.gotoNote(t)},n.state={catalogList:[{_id:L.a.recentlyArticlesKey,name:"\u6700\u8fd1\u6587\u6863",hasChild:!1,icon:"icon-wendang"},{_id:t.books.curBook+"_root",name:"\u6211\u7684\u6587\u4ef6\u5939",hasChild:!0}],treeChainList:[]},n}return Object(_.a)(e,t),Object(E.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.props.CATALOGS_GET().then(function(e){e.err||t.setCatalogsChainList()})}},{key:"setCatalogsChainList",value:function(){var t=this.props.catalogs,e=[];e.push(t.curCatalog);for(var n=t.curCatalog;t.list&&t.list[n]&&t.list[n].parentId;)n=t.list[n].parentId,e.push(n);this.setState({treeChainList:e})}},{key:"render",value:function(){var t=this,e=this.props,n=(e.books,e.catalogs);return r.a.createElement("div",{className:"layout-padding note-brief-layout"},this.state.catalogList.map(function(e,a){return r.a.createElement(D,{curNode:e,key:a,chooseCatalog:t.chooseCatalog,actCatalog:n.curCatalog,catalogs:n.list,treeChainList:t.state.treeChainList})}))}}]),e}(r.a.Component),R=function(t){function e(t){var n;return Object(g.a)(this,e),(n=Object(k.a)(this,Object(y.a)(e).call(this,t))).chooseBook=function(t){n.props.gotoNote(t)},n}return Object(_.a)(e,t),Object(E.a)(e,[{key:"componentDidMount",value:function(){this.props.BOOK_LIST_GET()}},{key:"render",value:function(){var t=this,e=this.props.books,n=Object.values(e.list);return r.a.createElement("div",{className:"layout-padding note-brief-layout"},n&&n.length&&n.map(function(n,a){return r.a.createElement("div",{className:"catalogs-layout",key:a},r.a.createElement("div",{className:e.curBook===n._id?"flex align-items-center catalogs-item-layout act":"flex align-items-center catalogs-item-layout",onClick:t.chooseBook.bind(t,n)},r.a.createElement("i",{className:"iconfont icon-shuji"}),r.a.createElement("div",{className:"catalogs-name line-ellipsis"},n.name)))}))}}]),e}(r.a.Component),M=function(t){function e(t){var n;return Object(g.a)(this,e),(n=Object(k.a)(this,Object(y.a)(e).call(this,t))).onClickOutsideHandler=function(t){console.log("!this.toggleContainer.current.contains(event.target)",!n.toggleContainer.current.contains(t.target)),(n.state.openBrief||n.state.openBook||n.state.openCatalogs)&&!n.toggleContainer.current.contains(t.target)&&n.setState({openBrief:!1,openBook:!1,openCatalogs:!1,noData:!1})},n.closeCom=function(){n.setState({openBrief:!1,openBook:!1,openCatalogs:!1})},n.openCom=function(t){n.closeCom(),n.setState(Object(O.a)({},t,!0))},n.gotoNoteFromNote=function(t){var e=n.props.match.params,a=e.bookId,r=e.catalogId;e.noteId;n.props.history.push("/".concat(a,"/").concat(r,"/").concat(t._id)),n.props.NOTE_CUR_UPDATE(t._id),n.closeCom()},n.gotoNoteFromCatalogs=function(){var t=Object(v.a)(b.a.mark(function t(e){var a,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.props.catalogs,r=n.props.match.params.bookId,n.closeCom(),a.curCatalog!==e._id){t.next=5;break}return t.abrupt("return");case 5:n.props.history.push("/".concat(r,"/").concat(e._id));case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),n.gotoNoteFromBooks=function(t){var e=n.props.match.params.bookId;n.closeCom(),e!==t._id&&(n.props.BOOK_CUR_UPDATE(t._id),n.props.history.push("/".concat(t._id,"/").concat(L.a.recentlyNoteKey)))},n.state={openBrief:!1,openBook:!1,openCatalogs:!1},n.toggleContainer=r.a.createRef(),n}return Object(_.a)(e,t),Object(E.a)(e,[{key:"componentDidMount",value:function(){window.addEventListener("click",this.onClickOutsideHandler),this.init()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.onClickOutsideHandler)}},{key:"init",value:function(){var t=this.props.match.params,e=t.bookId,n=t.catalogId,a=t.noteId;"none"!==a?(this.props.BOOK_CUR_UPDATE(e),this.props.CATALOGS_CUR_SAVE(n),this.props.NOTE_CUR_UPDATE(a),this.props.notes.list["".concat(e,"_").concat(n)]||this.props.NOTE_GET_BY_ID({id:a,bookId:e,catalogId:n})):this.setState({noData:!0})}},{key:"render",value:function(){var t=this.props.notes.curNote?this.props.notes.notesMap[this.props.notes.curNote]:"";return r.a.createElement("div",null,r.a.createElement(x,{openCom:this.openCom}),this.state.noData?r.a.createElement("div",{className:"no-data flex direction-column justify-content-center align-items-center absolute-full"},r.a.createElement("i",{className:"iconfont icon-wushuju"}),r.a.createElement("div",null,"\u8fd8\u6ca1\u4efb\u4f55\u6709\u7b14\u8bb0")):r.a.createElement("div",{className:"main-content"},t&&r.a.createElement(I,{curNote:t})),r.a.createElement("div",{ref:this.toggleContainer},r.a.createElement("div",null,this.state.openBrief&&r.a.createElement(U,Object.assign({},this.props,{gotoNote:this.gotoNoteFromNote}))),r.a.createElement("div",null,this.state.openCatalogs&&r.a.createElement(G,Object.assign({},this.props,{gotoNote:this.gotoNoteFromCatalogs}))),r.a.createElement("div",null,this.state.openBook&&r.a.createElement(R,Object.assign({},this.props,{gotoNote:this.gotoNoteFromBooks})))))}}]),e}(r.a.Component),P=n(23),Y=n(30),K=n(29),V=Object(i.b)(function(t){return{notes:Object(m.a)({},t.notes),catalogs:Object(m.a)({},t.catalogs),books:Object(m.a)({},t.books)}},function(t){return{NOTES_GET:function(e){return t(Object(P.NOTES_GET)(e))},NOTE_DES_GET:function(e){return t(Object(P.NOTE_DES_GET)(e))},NOTE_GET_BY_ID:function(e){return t(Object(P.NOTE_GET_BY_ID)(e))},NOTES_RECENTLY_GET:function(e){return t(Object(P.NOTES_RECENTLY_GET)(e))},NOTE_CUR_UPDATE:function(e){return t(Object(P.NOTE_CUR_UPDATE)(e))},CATALOGS_CUR_SAVE:function(e){return t(Object(Y.CATALOGS_CUR_SAVE)(e))},BOOK_CUR_UPDATE:function(e){return t(Object(K.BOOK_CUR_UPDATE)(e))},CATALOGS_GET:function(e){return t(Object(Y.CATALOGS_GET)(e))},BOOK_LIST_GET:function(e){return t(Object(K.BOOK_LIST_GET)(e))}}}),F=V(M),H=V(function(t){function e(t){var n;return Object(g.a)(this,e),(n=Object(k.a)(this,Object(y.a)(e).call(this,t))).state={showPage:!1},n}return Object(_.a)(e,t),Object(E.a)(e,[{key:"componentDidMount",value:function(){var t=Object(v.a)(b.a.mark(function t(){var e,n,a,r,o,c,i,s,u;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.props.match.params,n=e.bookId,a=e.catalogId,this.props.CATALOGS_CUR_SAVE(a),r=a.indexOf("root")>-1?"root":a,o=a===L.a.recentlyNoteKey?this.props.NOTES_RECENTLY_GET:this.props.NOTES_GET,t.t0=this.props.notes["".concat(n,"_").concat(r)],t.t0){t.next=9;break}return t.next=8,o();case 8:t.t0=t.sent;case 9:c=t.t0,i=c.err,s=c.data,i?this.setState({showPage:!0}):s.list&&s.list.length?(u=s.list[0]._id,this.props.history.push("/".concat(n,"/").concat(a,"/").concat(u))):this.props.history.push("/".concat(n,"/").concat(a,"/none"));case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,this.state.showPage&&"\u53d1\u751f\u4e86\u672a\u77e5\u9519\u8bef")}}]),e}(r.a.Component)),W=function(t){function e(t){var n;return Object(g.a)(this,e),(n=Object(k.a)(this,Object(y.a)(e).call(this,t))).handleInputChange=function(t){var e=t.target,a="checkbox"===e.type?e.checked:e.value,r=e.name;n.setState(Object(O.a)({},r,a))},n.todoLogin=function(){n.state.username&&n.state.password&&n.props.login({username:n.state.username,password:n.state.password}).then(function(t){t.err?alert(t.err.message):!function(t){if(!window)return"";var e=window.location.search.slice(1).split("&");if(!e.length)return"";var n={};return e.forEach(function(t){var e=t.split("=");n[e[0]]=e[1]}),t?n[t]:n}("back")?window.location="":window.history.back()})},n.state={username:"",password:"",errMsg:""},n}return Object(_.a)(e,t),Object(E.a)(e,[{key:"componentDidMount",value:function(){console.log("this.pros",this.props)}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"login-bg"},r.a.createElement("div",{className:"avatar-layout flex-all-center"},r.a.createElement("img",{src:"http://s2.sinaimg.cn/mw690/006VYTdfzy7pano0kENd1&690"})),r.a.createElement("div",{className:"flex flex-1 form-bg bg-fff login-layout"},r.a.createElement("div",{className:"form-layout"},r.a.createElement("div",{className:"form-group flex"},r.a.createElement("div",{className:"form-label-layout"},"\u7528\u6237\u540d\uff1a"),r.a.createElement("div",{className:"padding-input flex flex-1 align-items-center"},r.a.createElement("input",{className:"form-input",type:"text",value:this.state.username,name:"username",onChange:this.handleInputChange}))),r.a.createElement("div",{className:"form-group flex"},r.a.createElement("div",{className:"form-label-layout"},"\u5bc6\u7801\uff1a"),r.a.createElement("div",{className:"padding-input flex flex-1 align-items-center"},r.a.createElement("input",{className:"form-input",type:"text",value:this.state.password,name:"password",onChange:this.handleInputChange}))),r.a.createElement("div",{className:"form-group login-btn-layout"},r.a.createElement("div",{className:this.state.username&&this.state.password?"login-btn":"login-btn disable",onClick:this.todoLogin},"\u767b\u5f55")))))}}]),e}(r.a.Component),$=n(35),J=Object(i.b)(function(t){return{user:Object(m.a)({},t.user)}},function(t){return{login:function(e){return t(Object($.login)(e))}}})(W);var z=function(){return r.a.createElement("div",{className:"app"},r.a.createElement(p.a,null,r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/:bookId/:catalogId/:noteId",component:F}),r.a.createElement(f.b,{path:"/:bookId/:catalogId",component:H}),r.a.createElement(f.b,{path:"/login",component:J}),r.a.createElement(f.a,{to:"/default/recently"}))))};n(276),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(i.a,{store:d},r.a.createElement(z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},29:function(t,e,n){"use strict";n.r(e),n.d(e,"BOOK_LIST_GET",function(){return p}),n.d(e,"BOOK_CUR_UPDATE",function(){return f});var a=n(2),r=n.n(a),o=n(5),c=n(11),i=n(1),s=n(19),u=(n(17),n(3)),l={default:{_id:"default",name:"\u9ed8\u8ba4"}},d={list:l,curBook:"default"};function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e=Object(o.a)(r.a.mark(function e(n,a){var o,c,i,l,d,p,f,m,h,b;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a(),c=o.books,i=t.limit,l=void 0===i?0:i,d=t.start,p=void 0===d?0:d,f=t.force,void 0!==f&&f||!(Object.keys(c.list).length>1)){e.next=5;break}return e.abrupt("return",{err:null,data:{list:c.list}});case 5:return e.next=7,Object(s.a)({url:"/api/books",data:{limit:l,start:p}});case 7:return m=e.sent,h=m.err,b=m.data,h||n({type:u.b,payload:{data:b.list,start:p}}),e.abrupt("return",m);case 11:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}function f(t){return function(){var e=Object(o.a)(r.a.mark(function e(n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:u.a,payload:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,e=arguments.length>1?arguments[1]:void 0,n=e.type,a=void 0===n?"":n,r=e.payload,o=void 0===r?{}:r;if(a===u.b){var s=o.data,p=o.start?t.list:Object(i.a)({},l);return s.forEach(function(t){p[t._id]=t}),Object(i.a)({},t,{list:p})}if(a===u.c){var f=o;return Object(i.a)({},t,{list:Object(i.a)({},t.list,Object(c.a)({},f._id,f))})}if(a===u.a){var m=o;return Object(i.a)({},t,{curBook:m})}return t}},3:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return o}),n.d(e,"g",function(){return c}),n.d(e,"d",function(){return i}),n.d(e,"h",function(){return s}),n.d(e,"f",function(){return u}),n.d(e,"e",function(){return l}),n.d(e,"o",function(){return d}),n.d(e,"i",function(){return p}),n.d(e,"j",function(){return f}),n.d(e,"m",function(){return m}),n.d(e,"l",function(){return h}),n.d(e,"n",function(){return b}),n.d(e,"k",function(){return v});var a="BOOK_LIST_SAVE",r="BOOK_LIST_UPDATE",o="BOOK_CUR_UPDATE",c="CATALOGS_SAVE",i="CATALOGS_CUR_SAVE",s="CATALOGS_TEMPLATE_CREATE",u="CATALOGS_OPEN_TOGGLE",l="CATALOGS_OPEN_RESET",d="USER_SAVE",p="CUR_USER_INFO_SAVE",f="CUR_USER_LAYOUT_SAVE",m="NOTE_LIST_SAVE",h="NOTE_CUR_UPDATE",b="NOTE_MAP_SAVE",v="NOTE_CUR_CONTENT_UPDATE"},30:function(t,e,n){"use strict";n.r(e),n.d(e,"CATALOGS_GET",function(){return f}),n.d(e,"CATALOGS_CUR_SAVE",function(){return m});var a=n(2),r=n.n(a),o=n(5),c=n(32),i=n(11),s=n(1),u=n(19),l=n(17),d=n(3),p={list:{root:{_id:"root",parentId:"",bookId:"default"}},curCatalog:l.a.recentlyArticlesKey,isOpen:[]};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e=Object(o.a)(r.a.mark(function e(n,a){var o,c,i,s,l,p,m,h,b;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a(),c=o.catalogs,t.parentId=t.parentId||o.books.curBook+"_root",t.bookId=t.bookId||o.books.curBook,i=t.force,s=void 0!==i&&i,l=t.parentId,p=t.bookId,s||!c.list[t.parentId]||!c.list[t.parentId].childNodes){e.next=7;break}return e.abrupt("return",{err:null,data:c.list[t.parentId]});case 7:return e.next=9,Object(u.a)({url:"/api/catalogs",data:{parentId:l.indexOf("root")>0?"root":l,bookId:p}});case 9:return m=e.sent,h=m.err,b=m.data,h||(n({type:d.g,payload:{curNode:t,data:b,bookId:o.books.curBook}}),b.forEach(function(t){t.hasChild&&f({parentId:t._id,bookId:t.bookId,force:s})})),e.abrupt("return",m);case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}function m(t){return function(){var e=Object(o.a)(r.a.mark(function e(n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:d.d,payload:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,e=arguments.length>1?arguments[1]:void 0,n=e.type,a=e.payload;if(n===d.g){console.log("payload",a);var r=a.curNode,o=a.data,u=a.bookId,l="root"===r.parentId?u+"_root":r.parentId,f=Object(s.a)({},Object(i.a)({},l,Object(s.a)({},t.list[r.parentId],{updateTime:(new Date).getTime(),childNodes:o})));return o.forEach(function(t){f[t._id]=Object(s.a)({},t)}),Object(s.a)({},t,{list:Object(s.a)({},t.list,f)})}if(n===d.d){var m=a;return Object(s.a)({},t,{curCatalog:m})}if(n===d.h){var h=a,b={name:"\u65b0\u5efa\u6587\u4ef6\u5939",isNew:!0,parentId:h},v=t.list[h]?t.list[h]:[],O=[b].concat(Object(c.a)(v));return Object(s.a)({},t,{list:Object(s.a)({},t.list,Object(i.a)({},h,O))})}if(n===d.f){var g=a.id,E=a.force,k=Object(c.a)(t.isOpen),y=k.indexOf(g);return y<0?k=[].concat(Object(c.a)(k),[g]):!E&&y>-1&&k.splice(y,1),Object(s.a)({},t,{isOpen:k})}return n===d.e?Object(s.a)({},t,{isOpen:[]}):t}},34:function(t,e,n){"use strict";n.r(e);var a=n(20),r=n(67),o={};r.keys().forEach(function(t){"./index.js"!==t&&(o[t.replace(/(\.\/|\.js)/g,"")]=r(t).default)}),e.default=Object(a.combineReducers)(o)},35:function(t,e,n){"use strict";n.r(e),n.d(e,"login",function(){return l}),n.d(e,"USER_INFO_GET",function(){return d});var a=n(2),r=n.n(a),o=n(5),c=n(1),i=n(19),s=(n(17),n(3)),u={userInfo:{},curUserInfo:{},userInfoStatus:""};function l(t){return function(){var e=Object(o.a)(r.a.mark(function e(n,a){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)({url:"/api/login",method:"post",data:t,notAlert:!0});case 2:return(o=e.sent).err||n({type:s.o,payload:o.data}),e.abrupt("return",o);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}function d(t){return function(){var t=Object(o.a)(r.a.mark(function t(e,n){var a,o,c;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n(),!(o=a.user).userInfo.username){t.next=4;break}return t.abrupt("return",{err:null,data:o.userInfo});case 4:return t.next=6,Object(i.a)({url:"/api/getUserInfo"});case 6:return(c=t.sent).err||e({type:s.o,payload:c.data}),t.abrupt("return",c);case 9:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,e=arguments.length>1?arguments[1]:void 0,n=e.type,a=e.payload;if(n===s.o){var r=a;return Object(c.a)({},t,{userInfo:Object(c.a)({},r)})}if(n===s.i){var o=a;return Object(c.a)({},t,{curUserInfo:Object(c.a)({},o)})}if(n===s.j){var i=a;return Object(c.a)({},t,{userInfoStatus:Object(c.a)({},i)})}return t}},39:function(t,e,n){"use strict";var a="67.209.187.22",r={devHost:"10.5.23.29:3001",proHost:a,mockHost:"http://".concat(a,":3000")};e.a={base:r}},56:function(t,e,n){t.exports=n(277)},67:function(t,e,n){var a={"./books.js":29,"./catalogs.js":30,"./index.js":34,"./notes.js":23,"./user.js":35};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=o,t.exports=r,r.id=67},85:function(t,e,n){},86:function(t,e,n){},87:function(t,e,n){}},[[56,1,2]]]);
//# sourceMappingURL=main.137d5119.chunk.js.map